<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Joeyonng - Mobile Nets</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Joeyonng</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../Knowledge" rel="" target="">
 <span class="menu-text">Knowledge</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Notes" rel="" target="">
 <span class="menu-text">Notes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://joeyonng.github.io/joeyonng-backyard/" rel="" target="">
 <span class="menu-text">Backyard</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#standard-2d-convolution-layer-preliminary" id="toc-standard-2d-convolution-layer-preliminary" class="nav-link active" data-scroll-target="#standard-2d-convolution-layer-preliminary">Standard 2D convolution layer (Preliminary)</a></li>
  <li><a href="#standard-2d-convolution-layer-preliminary-1" id="toc-standard-2d-convolution-layer-preliminary-1" class="nav-link" data-scroll-target="#standard-2d-convolution-layer-preliminary-1">Standard 2D convolution layer (Preliminary)</a></li>
  <li><a href="#depthwise-separable-convolution-mobilenetv1" id="toc-depthwise-separable-convolution-mobilenetv1" class="nav-link" data-scroll-target="#depthwise-separable-convolution-mobilenetv1">Depthwise separable convolution (MobileNetV1)</a></li>
  <li><a href="#inverted-residual-and-linear-bottleneck-block-mobilenetv2" id="toc-inverted-residual-and-linear-bottleneck-block-mobilenetv2" class="nav-link" data-scroll-target="#inverted-residual-and-linear-bottleneck-block-mobilenetv2">Inverted residual and linear bottleneck block (MobileNetV2)</a></li>
  <li><a href="#squeeze-and-excite-mobilenetv3" id="toc-squeeze-and-excite-mobilenetv3" class="nav-link" data-scroll-target="#squeeze-and-excite-mobilenetv3">Squeeze-and-Excite (MobileNetV3)</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-page-left" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Mobile Nets</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p><em>05-01-2021</em></p>
<p>This page contains my reading notes on</p>
<ul>
<li><a href="https://www.semanticscholar.org/paper/MobileNets%3A-Efficient-Convolutional-Neural-Networks-Howard-Zhu/3647d6d0f151dc05626449ee09cc7bce55be497e"><strong>MobileNets: Efficient Convolutional Neural Networks for Mobile Vision Applications</strong></a></li>
<li><a href="https://www.semanticscholar.org/paper/MobileNetV2%3A-Inverted-Residuals-and-Linear-Sandler-Howard/dd9cfe7124c734f5a6fc90227d541d3dbcd72ba4"><strong>MobileNetV2: Inverted Residuals and Linear Bottlenecks</strong></a></li>
<li><a href="https://www.semanticscholar.org/paper/Searching-for-MobileNetV3-Howard-Sandler/83d074cc5051ade0c08d66180e4a04d2c112fa97"><strong>Searching for MobileNetV3</strong></a></li>
<li><a href="https://www.semanticscholar.org/paper/Squeeze-and-Excitation-Networks-Hu-Shen/df67d46e78aae0d2fccfb6212d101a342259c01b"><strong>Squeeze-and-Excitation Networks</strong></a></li>
</ul>
<section id="standard-2d-convolution-layer-preliminary" class="level2">
<h2 class="anchored" data-anchor-id="standard-2d-convolution-layer-preliminary">Standard 2D convolution layer (Preliminary)</h2>
<ol type="1">
<li>Convolution layer takes as input <span class="math inline">M</span> matrices (<span class="math inline">M</span> input channels) of shape <span class="math inline">D_i \times D_i</span>, which can be seen as a 3D volume of size <span class="math inline">D_i \times D_i \times M</span>.</li>
<li>Each convolution layer consists of <span class="math inline">N</span> sets of learnable weights (<span class="math inline">N</span> filters or <span class="math inline">N</span> output channels), each of which corresponds to a learnable bias. Each set of learnable weights (a filter) is a small 3D volume with size <span class="math inline">D</span> and same depth as the input volume <span class="math inline">M</span>, i.e.&nbsp;<span class="math inline">M</span> matrices of shape <span class="math inline">D \times D</span>.</li>
<li>The output activation of the convolution layer has the <span class="math inline">N</span> matrices of shape <span class="math inline">D_o \times D_o</span>, which can also be seen as a 3D volume of size <span class="math inline">D_o \times D_o \times M</span>.
<ol type="1">
<li><span class="math inline">D_o</span> is computed as: <span class="math display"> D_o = \frac{D_i - D}{S} + 1 </span></li>
</ol></li>
<li>In the equation above, <span class="math inline">S</span> is stride, which tells how many pixels the filter moves each time. The input matrices will usually be zero-padded to control the output size.</li>
<li>The animation below shows exactly how the output of a convolution layer is computed.</li>
</ol>
</section>
<section id="standard-2d-convolution-layer-preliminary-1" class="level2">
<h2 class="anchored" data-anchor-id="standard-2d-convolution-layer-preliminary-1">Standard 2D convolution layer (Preliminary)</h2>
<ol type="1">
<li>Convolution layer takes as input <span class="math inline">M</span> matrices (<span class="math inline">M</span> input channels) of shape <span class="math inline">D_i \times D_i</span>, which can be seen as a 3D volume of size <span class="math inline">D_i \times D_i \times M</span>.</li>
<li>Each convolution layer consists of <span class="math inline">N</span> sets of learnable weights (<span class="math inline">N</span> filters or <span class="math inline">N</span> output channels), each of which corresponds to a learnable bias. Each set of learnable weights (a filter) is a small 3D volume with size <span class="math inline">D</span> and same depth as the input volume <span class="math inline">M</span>, i.e.&nbsp;<span class="math inline">M</span> matrices of shape <span class="math inline">D \times D</span>.</li>
<li>The output activation of the convolution layer has the <span class="math inline">N</span> matrices of shape <span class="math inline">D_o \times D_o</span>, which can also be seen as a 3D volume of size <span class="math inline">D_o \times D_o \times M</span>.
<ol type="1">
<li><span class="math inline">D_o</span> is computed as: <span class="math display"> D_o = \frac{D_i - D}{S} + 1 </span></li>
</ol></li>
<li>In the equation above, <span class="math inline">S</span> is stride, which tells how many pixels the filter moves each time. The input matrices will usually be zero-padded to control the output size.</li>
<li>The animation below shows exactly how the output of a convolution layer is computed.</li>
</ol>
<div class="cell" data-jupyter="{&quot;source_hidden&quot;:true}" data-tags="[&quot;remove-input&quot;]" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> IFrame</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>IFrame(<span class="st">'https://cs231n.github.io/assets/conv-demo/index.html'</span>, width<span class="op">=</span><span class="dv">792</span>, height<span class="op">=</span><span class="dv">700</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">

        <iframe width="792" height="700" src="https://cs231n.github.io/assets/conv-demo/index.html" frameborder="0" allowfullscreen=""></iframe>
        
</div>
</div>
</section>
<section id="depthwise-separable-convolution-mobilenetv1" class="level2">
<h2 class="anchored" data-anchor-id="depthwise-separable-convolution-mobilenetv1">Depthwise separable convolution (MobileNetV1)</h2>
<ol type="1">
<li>Instead of using the traditional convolution layers as the building blocks, MobileNetV1 uses layers called depthwise separable convolutions.</li>
<li>Each depthwise separable convolution consists of two layers:
<ol type="1">
<li>Depthwise convolution layer: it has <span class="math inline">M</span> separate filters of shape <span class="math inline">D \times D \times 1</span>, where the <span class="math inline">m</span>th filter is applied to the <span class="math inline">m</span>th input channel. This layer can also be thought to have 1 filter of shape <span class="math inline">D \times D \times M</span>, but the output channels will not be added together. In this way, the output size is <span class="math inline">D_o \times D_o \times M</span>.</li>
<li>Pointwise convolution layer: it has <span class="math inline">N</span> separate filters of shape <span class="math inline">1 \times 1 \times M</span>. Each filter is doing a linear combination of the matrices (input channels) of the input volume, and thus <span class="math inline">N</span> filters will have <span class="math inline">N</span> matrices (output channels). It takes the output of depthwise convolution as the input, and the output of pointwise convolution has the shape of <span class="math inline">D_o \times D_o \times N</span>, just like the output of a standard convolution layer.</li>
</ol></li>
<li>Each filter in a convolution layer both filters and combines inputs in one step. Depthwise separable convolution splits this into two layers: depthwise convolution does filtering while pointwise convolution combines.</li>
<li>Computational cost comparison:
<ol type="1">
<li>Standard convolution layer (assuming stride is 1): <span class="math inline">D_i \times D_i \times D \times D \times M \times N</span></li>
<li>Depthwise convolution layer (assuming stride is 1): <span class="math inline">D_i \times D_i \times D \times D \times M</span></li>
<li>Pointwise convolution layer: <span class="math inline">D \times D \times M \times N</span></li>
<li>Thus the computation cost of depthwise separable convolution is less than that of the standard convolution layer: <span class="math display"> \frac{D_i \times D_i \times D \times D \times M + D \times D \times M \times N}{D_i \times D_i \times D \times D \times M \times N} = \frac{1}{N} + \frac{1}{D_i^2} </span></li>
</ol></li>
</ol>
<div class="cell" data-jupyter="{&quot;source_hidden&quot;:true}" data-tags="[&quot;remove-input&quot;]" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> Image</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>Image(filename<span class="op">=</span><span class="st">'./1.png'</span>, width<span class="op">=</span><span class="dv">480</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<p><img src="MobileNets_files/figure-html/cell-3-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="inverted-residual-and-linear-bottleneck-block-mobilenetv2" class="level2">
<h2 class="anchored" data-anchor-id="inverted-residual-and-linear-bottleneck-block-mobilenetv2">Inverted residual and linear bottleneck block (MobileNetV2)</h2>
<ol type="1">
<li>The improvement of this layer over the depthwise separable convolution is based on the following two assumptions:
<ol type="1">
<li>Although Non-linear activations (Relu) can increase representational complexity, it will result in information loss if the input doesn’t have lots of channels.</li>
<li>Activation maps are able to be encoded in low-dimensional subspaces (less channels).</li>
</ol></li>
<li>An expansion layer is appended to the front of the depthwise separable convolution. If the input has the shape of <span class="math inline">D_i \times D_i \times M</span>, the expansion layer is a pointwise convolution layer that has <span class="math inline">tM</span> filters of size <span class="math inline">1 \times 1 \times M</span>, where <span class="math inline">t</span> is called expansion factor/ratio and should be larger than 1. The output will have the shape <span class="math inline">D_i \times D_i \times tM</span>. The layer expands the low-dimensional (less channels) input activation map to a higher-dimensional (more channels) space suited to non-linear activation functions.</li>
<li>Non-linear activation functions (Relu6) can only be applied to the high-dimensional activation maps. The last pointwise convolution layer projects the high-dimensional space back into low-dimensional space, so it can only have linear activation functions. Therefore, linear bottleneck block has three layers:
<ol type="1">
<li>Expansion layer: <span class="math inline">tM</span> filters of <span class="math inline">1 \times 1 \times M</span>, Relu6.</li>
<li>Depthwise convolution layer: 1 filter of <span class="math inline">D \times D \times tM</span> (Dwise), Relu6.</li>
<li>Pointwise convolution layer: <span class="math inline">M'</span> filters of <span class="math inline">1 \times 1 \times tM</span>, Linear.</li>
</ol></li>
<li>If the initial and final activation maps of the block are of the same dimensions, a residual connection between the input and output of the block (between expansion layers from two consecutive blocks) is added to aid gradient flow during back-propagation, which is achieved by:
<ol type="1">
<li>Depthwise convolution stride equals (<span class="math inline">S = 1</span>).</li>
<li>Input and output channels are equal (<span class="math inline">M' = M</span>).</li>
</ol></li>
<li>The paper emphasizes that the connection is added between the expansion layers (inverted residual connection) instead of between depthwise convolution layer (residual connection), so that the connections are created between the low-dimensional activation maps.</li>
</ol>
<div class="cell" data-jupyter="{&quot;source_hidden&quot;:true}" data-tags="[&quot;remove-input&quot;]" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> Image</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>Image(filename<span class="op">=</span><span class="st">'./2.png'</span>, width<span class="op">=</span><span class="dv">480</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<p><img src="MobileNets_files/figure-html/cell-4-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-jupyter="{&quot;source_hidden&quot;:true}" data-tags="[&quot;remove-input&quot;]" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> Image</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>i <span class="op">=</span> Image(filename<span class="op">=</span><span class="st">'./3.png'</span>, width<span class="op">=</span><span class="dv">480</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>i </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<p><img src="MobileNets_files/figure-html/cell-5-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="squeeze-and-excite-mobilenetv3" class="level2">
<h2 class="anchored" data-anchor-id="squeeze-and-excite-mobilenetv3">Squeeze-and-Excite (MobileNetV3)</h2>
<ol type="1">
<li>MobileNetV3 uses the block that modifies the inverted residual block by adding a Squeeze-and-Excite block between the depthwise convolution layer and pointwise convolution layer.</li>
<li>Given an input that has the shape <span class="math inline">D_i \times D_i \times M</span>, Squeeze-and-Excite block in the original paper consists of three parts:
<ol type="1">
<li>Squeeze: apply global average pooling to the input, so that all information in each input channel is “squeezed” into a single channel descriptor. Each descriptor is a single value that summarizes each channel of the input. The output shape of this layer is <span class="math inline">1 \times 1 \times M</span>.</li>
<li>Excite: apply two fully connected layers to the output of the Squeeze layer. Use Relu activation function for the first layer and Sigmoid activation function for the second layer. The first layer contains <span class="math inline">\frac{M}{r}</span> number of neurons, and thus the output of the first layer reduces the dimension by a reduction ratio <span class="math inline">r</span>. The second layer contains <span class="math inline">M</span> number of neurons to restore the output dimension to be the same as the output of the Squeeze layer.</li>
<li>Scale: the <span class="math inline">M</span> coefficients of the output of the Excite layer are timed with <span class="math inline">M</span> channels of input of the block to form the output of the block.</li>
</ol></li>
</ol>
<div class="cell" data-jupyter="{&quot;source_hidden&quot;:true}" data-tags="[&quot;remove-input&quot;]" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> Image</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>Image(filename<span class="op">=</span><span class="st">'./4.png'</span>, width<span class="op">=</span><span class="dv">960</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<p><img src="MobileNets_files/figure-html/cell-6-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-jupyter="{&quot;source_hidden&quot;:true}" data-tags="[&quot;remove-input&quot;]" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> Image</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>Image(filename<span class="op">=</span><span class="st">'./5.png'</span>, width<span class="op">=</span><span class="dv">480</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<p><img src="MobileNets_files/figure-html/cell-7-output-1.png" class="img-fluid"></p>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>